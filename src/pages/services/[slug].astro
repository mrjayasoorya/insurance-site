---
import ServiceLayout from "../../layouts/ServiceLayout.astro";
import PageHero from "../../components/PageHero.astro";
import Breadcrumbs from "../../components/Breadcrumbs.astro";
import LinkGrid from "../../components/LinkGrid.astro";
import FAQBlock from "../../components/FAQBlock.astro";

import { servicePages } from "../../content/pages/services";
import { siteData } from "../../content/siteData";

const { slug } = Astro.params;
const page = servicePages[slug];

if (!page) return Astro.redirect("/services");

const breadcrumbItems = [
  { label: "Home", href: "/" },
  { label: "Services", href: "/services" },
  { label: page.h1, href: page.href },
];
---

<ServiceLayout page={{...page, areasServed: siteData.brand.areaChips}} breadcrumbItems={breadcrumbItems}>
  <section class="section section-padding">
    <Breadcrumbs items={breadcrumbItems} />
  </section>

  <PageHero
    h1={page.h1}
    subtitle={page.metaDesc}
    chips={[...page.scan3s, ...page.proof10s]}
    primaryCta={{ label: "Call for Clarity", href: `tel:${siteData.brand.phoneE164}` }}
    secondaryCta={{ label: "WhatsApp for Guidance", href: `https://wa.me/${siteData.brand.whatsappE164}?text=${encodeURIComponent(siteData.brand.whatsappPrefill)}`, target:"_blank", rel:"noopener" }}
  />

  <!-- 30s action block -->
  <section class="section section-padding" aria-label="What we do">
    <h2 class="section-title">{page.action30s.title}</h2>
    <ul class="bullets">
      {page.action30s.points.map((p)=> <li>{p}</li>)}
    </ul>
  </section>

  <!-- WHO -->
  <section class="section section-padding" aria-label="Who this is for">
    <h2 class="section-title">Who this is for</h2>
    <ul class="bullets">
      {page.whoThisIsFor.map((p)=> <li>{p}</li>)}
    </ul>
  </section>

  <!-- WHERE -->
  <section class="section section-padding" aria-label="Where we operate">
    <h2 class="section-title">Where we operate</h2>
    <p class="section-sub">Sholavaram base + nearby NH/industrial belts. Domestic support across major Chennai areas.</p>
    <div class="grid grid-2">
      <article class="card">
        <h3 class="card-title">Primary belts</h3>
        <ul class="bullets">{page.whereWeOperate.primary.map((x)=> <li>{x}</li>)}</ul>
      </article>
      <article class="card">
        <h3 class="card-title">Nearby belts</h3>
        <ul class="bullets">{page.whereWeOperate.citySupport?.map((x)=> <li>{x}</li>)}</ul>
      </article>
    </div>
    {page.whereWeOperate.citySupport?.length ? (
      <article class="card" style="margin-top:12px;">
        <h3 class="card-title">Chennai city domestic support</h3>
        <ul class="bullets">{page.whereWeOperate.citySupport.map((x)=> <li>{x}</li>)}</ul>
      </article>
    ) : null}
  </section>

  <!-- WHY (local risk) -->
  <section class="section section-padding" aria-label="Local risk notes">
    <h2 class="section-title">Local risk notes (why this matters here)</h2>
    <ul class="bullets">
      {page.localRiskNotes.map((x)=> <li>{x}</li>)}
    </ul>
  </section>

  <!-- Claim-side authority -->
  <section class="section section-padding" aria-label="Common claim failures">
    <h2 class="section-title">Common claim failures we help prevent</h2>
    <ul class="bullets">
      {page.commonClaimFailures.map((x)=> <li>{x}</li>)}
    </ul>
  </section>

  <!-- Checklist -->
  <section class="section section-padding" aria-label="What to keep ready">
    <h2 class="section-title">What to keep ready before calling</h2>
    <ul class="bullets">
      {page.checklist.map((x)=> <li>{x}</li>)}
    </ul>
  </section>

  <!-- Internal links -->
  <LinkGrid
    title="Related pages (complete the circle)"
    subtitle="Strong internal linking helps both Google and LLMs understand the cluster."
    items={[
      ...(page.internalLinks.relatedServices || []),
      ...(page.internalLinks.relatedArticles || []),
      ...(page.internalLinks.locations || []),
    ]}
  />

  <FAQBlock title="FAQs (contextual)" items={page.faqs || []} />
</ServiceLayout>
