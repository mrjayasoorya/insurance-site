---
// src/components/QuickHelpLinks.astro
// Small “Quick help” section used across pages (Home / Services / FAQs / Locations / Service pages).

import { EN, siteData } from "../content/siteData";
import { getIntentLinks } from "../lib/getIntentLinks";

type PageType =
  | "home"
  | "services"
  | "serviceCategory"
  | "serviceDetail"
  | "locations"
  | "locationDetail"
  | "faqs"
  | "about"
  | "generic";

const {
  pageType = "generic",
  title = "Quick help",
  subtitle = "Popular actions people search for — renewals, claims, and finding an insurance office nearby.",
  max = 6,
} = Astro.props as {
  pageType?: PageType;
  title?: string;
  subtitle?: string;
  max?: number;
};

// const all = siteData.intentPagesURLs || {}; // you will add this in siteData
// const group = all[pageType] || all.generic || [];
const group = getIntentLinks(pageType);
console.log({group});

const items = (group || [])
  .slice(0, max)
  .map((x: any) => ({
    title: x.title,
    desc: x.desc,
    href: EN(x.href),
  }))
  .filter((x: any) => x.title && x.href);
---

<section class="section section-padding" aria-label="Quick help links">
  <h2 class="section-title">{title}</h2>
  <p class="section-sub readable">{subtitle}</p>

  <div class="qh-grid" role="list">
    {items.map((it) => (
      <a class="qh-card" href={it.href} role="listitem">
        <span class="qh-title">{it.title}</span>
        {it.desc ? <span class="qh-desc">{it.desc}</span> : null}
      </a>
    ))}
  </div>
</section>

<style is:global>
  .qh-grid {
    margin-top: 12px;
    display: grid;
    gap: 12px;
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
  .qh-card {
    display: block;
    padding: 12px 14px;
    border: 1px solid var(--border);
    border-radius: 16px;
    background: var(--surface);
    text-decoration: none;
    box-shadow: 0 2px 10px rgba(11, 13, 18, 0.05);
  }
  .qh-title {
    display: block;
    font-weight: 950;
    letter-spacing: -0.01em;
    font-size: 14px;
  }
  .qh-desc {
    display: block;
    margin-top: 6px;
    color: var(--muted);
    font-size: 13px;
    line-height: 1.35;
  }
  @media (max-width: 980px) {
    .qh-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
